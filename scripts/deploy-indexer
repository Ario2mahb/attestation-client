export USER=ubuntu
export SERVER=34.89.247.51

export CURRENT_DIR=$(pwd)
export WORKDIR="global/indexer"
export MCC_WORKDIR="global/mcc"
export DEPLOY_NAME="indexer"

export MCC_LOCAL_FOLDER="../mcc"
export FNAME=latest-attester-client.tgz
export MCC_FNAME=mcc.tgz
export BACKUPDIR="global/.backup"
export CONFIGDIR="global/.config"

export BRANCH=main
export MCC_BRANCH=master

export SERVICE1=indexer-xrp
export SERVICE2=indexer-btc
export SERVICE3=indexer-ltc
export SERVICE4=indexer-algo
export SERVICE5=indexer-doge

# main script
bash ./scripts/deploy-copy-internal

# Restart the app as a service.
echo -e "${GREENBOLD}Build successful.${NC} Restarting indexers"
ssh -n $USER@$SERVER "systemctl --user restart $SERVICE1" || { echo "Restarting $SERVICE1 failed" ; exit 1; }
ssh -n $USER@$SERVER "systemctl --user restart $SERVICE2" || { echo "Restarting $SERVICE2 failed" ; exit 1; }
ssh -n $USER@$SERVER "systemctl --user restart $SERVICE3" || { echo "Restarting $SERVICE3 failed" ; exit 1; }
ssh -n $USER@$SERVER "systemctl --user restart $SERVICE4" || { echo "Restarting $SERVICE4 failed" ; exit 1; }
ssh -n $USER@$SERVER "systemctl --user restart $SERVICE5" || { echo "Restarting $SERVICE5 failed" ; exit 1; }
echo -e "${GREENBOLD}Done.${NC}"
